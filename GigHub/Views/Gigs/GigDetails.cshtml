@model GigHub.ViewModels.GigDetailsViewModel 
@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="gig-details">
    <h2>@Model.ArtistName</h2>
    @if(Model.Following == true)
    {
        <button class="btn btn-primary">Following</button>
    }
    else
    {
        <button class="btn btn-secondary js-follow-artist" data-artist-id="@Model.ArtistId">Follow</button>
    }
    
    <p>Performing at @Model.Venue on @Model.EventDate() at @Model.EventTime()</p>

    @if(Model.Following == true)
    {
        <p>You are going to this event.</p>
    }

</div>

@section scripts{
    <script>

        $(document).ready(function () {

            $(".js-follow-artist").click(function (e) {

                let self = e.target;
                $.post({
                    url: "/api/followers/follow/" + e.target.getAttribute("data-artist-id"),
                    success: function () { $(self).removeClass("js-follow-artist").removeClass("data-artist-id").text = "Following" },
                    error: function () { alert("an error occurred.")}
                });
            });






        });
        
        
        
        

    </script>
}

